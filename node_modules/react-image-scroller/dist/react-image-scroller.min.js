!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("emotion")):"function"==typeof define&&define.amd?define(["react","emotion"],t):e.ImageScroller=t(e.React,e.emotion)}(this,function(R,P){"use strict";var t,c,r,u,H="default"in R?R.default:R;function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function q(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function n(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function B(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function D(){var e=n(["\n                                    flex: 0 0 auto;\n                                    height: 100%;\n                                    width: auto;\n                                    max-width: 100%;\n                                    object-fit: contain;\n                                    overflow-y: auto;\n                                    display: block;\n                                    user-select: none;\n\n                                    * {\n                                        /* height: 100%; */\n                                        /* width: auto; */\n                                        max-width: 100%;\n                                        object-fit: contain;\n                                    }\n                                "]);return D=function(){return e},e}function F(){var e=n(["\n                            position: absolute;\n                            height: 100%;\n                            left: 0;\n                            right: 0;\n                            pointer-events: none;\n                            z-index: 20;\n                            * {\n                                pointer-events: auto;\n                            }\n                        "]);return F=function(){return e},e}function V(){var e=n(["\n                    height: 28em;\n                "]);return V=function(){return e},e}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;var i,o,a=0|t,l=Math.max(0<=a?a:r-Math.abs(a),0);for(;l<r;){if((i=n[l])===(o=e)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;l++}return!1}}),Array.from||(Array.from=(t=Object.prototype.toString,c=function(e){return"function"==typeof e||"[object Function]"===t.call(e)},r=Math.pow(2,53)-1,u=function(e){var t,n=(t=Number(e),isNaN(t)?0:0!==t&&isFinite(t)?(0<t?1:-1)*Math.floor(Math.abs(t)):t);return Math.min(Math.max(n,0),r)},function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,r=1<arguments.length?arguments[1]:void 0;if(void 0!==r){if(!c(r))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(n=arguments[2])}for(var i,o=u(t.length),a=c(this)?Object(new this(o)):new Array(o),l=0;l<o;)i=t[l],a[l]=r?void 0===n?r(i,l):r.call(n,i,l):i,l+=1;return a.length=o,a}));var _="FULLY_VISIBLE",X="PARTIALLY_VISIBLE";return H.forwardRef(function(e,t){var n=e.children,r=e.className,i=void 0===r?"":r,o=e.hideScrollbar,a=void 0===o||o,l=e.innerClassName,c=void 0===l?"":l,s=(e.innerStyle,e.items),u=e.onChange,f=void 0===u?function(){}:u,h=e.renderWithin,d=void 0===h?null:h,v=e.scrollOnClick,y=void 0===v||v,p=e.scrollWithArrows,m=void 0===p||p,b=e.scrollContainerClassName,g=void 0===b?"":b,w=e.scrollContainerStyle,x=void 0===w?{}:w,O=q(e,["children","className","hideScrollbar","innerClassName","innerStyle","items","onChange","renderWithin","scrollOnClick","scrollWithArrows","scrollContainerClassName","scrollContainerStyle"]);s=s||H.Children.toArray(n);var E=R.useRef(null),j=R.useRef(null),A=R.useRef(null),N=z(R.useState({previous:null,current:[],next:null}),2),S=N[0],I=N[1];function C(){k(S.next,"nearest")}function L(){k(S.previous,"nearest")}function k(o){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"center";if(!(null==o||o<0)){o=Math.min(o,s.length-1);var a=E.current.offsetWidth,t=A.current.children[o];if(t)if("center"===e){var n=(a-t.offsetWidth)/2;j.current.scrollTo({top:0,left:t.offsetLeft-n,behavior:"smooth"})}else if("nearest"===e){var r,i=function(e,t){for(var n=0;;){var r=A.current.children[o+t];if(!r)break;var i=r.offsetWidth;if(!(e+n+i<a))break;n+=i,t+=t}return n};r=0<S.current.length?o>S.current[0]?-1:1:o>S.previous?-1:1;var l=i(t.offsetWidth,r),c=i(t.offsetWidth+l,-r),u=t.offsetWidth+l+c,f=(a-u)/2;j.current.scrollTo({top:0,left:t.offsetLeft-(1===r?c:l)-f,behavior:"smooth"}),0===t.offsetLeft&&E.current.focus()}}}return R.useLayoutEffect(function(){var e=E.current,t=j.current;if(t.style.overflowX="scroll",a){e.style.overflowY="hidden";var n=e.clientHeight-t.clientHeight;t.style.height="calc(100% + ".concat(n,"px)")}else e.style.overflowY="",t.style.height="100%";B(A.current.children).forEach(function(e){e.style.height="".concat(t.clientHeight,"px")}),B(t.children).forEach(function(e){e.style.maxHeight="".concat(t.clientHeight,"px")})},[a]),R.useEffect(function(){var l=new Map,t=new IntersectionObserver(function(e){e.forEach(function(e){l.set(parseInt(e.target.getAttribute("data-item-id"),10),e.intersectionRatio)});var t,n,r,i,o,a=(t=B(A.current.children).map(function(e){var t=e.getAttribute("data-item-id");t=parseInt(t,10);var n=l.get(t);return{index:t,visibility:.98<n?_:0===n?"NOT_VISIBLE":X}}),i=[],o=r=null,t.forEach(function(e){e.visibility===_?i.push(e.index):e.visibility===X&&n&&n.visibility===X?(r=n.index,o=e.index):0===i.length&&null===o?r=e.index:0<i.length&&null===o&&(o=e.index),n=e}),{previous:r,current:i,next:o});I(a),f(a)},{root:j.current,threshold:[0,.98]});B(A.current.children).forEach(function(e){t.observe(e)})},[]),R.useEffect(function(){function e(e){m&&E.current.contains(e.target)&&("ArrowRight"===e.key?(e.preventDefault(),C()):"ArrowLeft"===e.key&&(e.preventDefault(),L()))}return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[C,L]),R.useImperativeHandle(t,function(){return{next:C,previous:L,scrollTo:k}},[C,L,k]),H.createElement("div",Y({ref:E,tabIndex:0},O,{className:i+" "+P.css(V())}),H.createElement("div",(T={ref:j,style:x,className:g},W="style",M={height:"100%",overflowX:"scroll"},W in T?Object.defineProperty(T,W,{value:M,enumerable:!0,configurable:!0,writable:!0}):T[W]=M,T),d&&H.createElement("div",{className:P.css(F())},d({scrollTo:k,next:C,previous:L,items:s,status:S})),H.createElement("div",{ref:A,className:c,style:{display:"flex",height:"100%",position:"relative"}},s.map(function(e,t){return H.cloneElement(e,{"data-item-id":t,key:t,onClick:function(e){y&&(e.preventDefault(),S.current.includes(t)?k(t,"centre"):k(t,"nearest"))},className:P.css(D())+" "+(e.props.className||"")})}))));var T,W,M})});
